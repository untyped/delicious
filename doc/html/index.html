<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>Delicious.plt</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /></head><body><div class="tocview"><div class="tocviewtitle"><a href="index.html" class="tocviewlink">Delicious.plt</a></div><div>&nbsp;</div><table class="tocviewlist" cellspacing="0"><tr><td align="right">1<tt>&nbsp;</tt></td><td><a href="index.html#(part Introduction)" class="tocviewlink">Introduction</a></td></tr><tr><td align="right">2<tt>&nbsp;</tt></td><td><a href="index.html#(part config)" class="tocviewlink">Configuration</a></td></tr><tr><td align="right">3<tt>&nbsp;</tt></td><td><a href="index.html#(part api)" class="tocviewlink">API Wrappers</a></td></tr><tr><td align="right">4<tt>&nbsp;</tt></td><td><a href="index.html#(part internals)" class="tocviewlink">Internal Procedures</a></td></tr><tr><td align="right">5<tt>&nbsp;</tt></td><td><a href="index.html#(part testing)" class="tocviewlink">Testing</a></td></tr><tr><td align="right">6<tt>&nbsp;</tt></td><td><a href="index.html#(part Acknowledgements)" class="tocviewlink">Acknowledgements</a></td></tr></table></div><div class="main"><h2><a name="(part Delicious_plt)"></a>Delicious.plt</h2><p>Dave Gurnell and Noel Welsh (<tt>{dave, noel} at untyped</tt>)</p><h3>1<tt>&nbsp;</tt><a name="(part Introduction)"></a>Introduction</h3><p>This library provides structures and procedures for accessing the HTTP API of the del.icio.us social bookmarking service. The library handles all connection, encryption and authentication with del.icio.us, allowing the programmer to concentrate on application logic.</p><p>This release of the library supports version 1.0 of the del.icio.us API.</p><table cellspacing="0"></table><h3>2<tt>&nbsp;</tt><a name="(part config)"></a>Configuration</h3><p>Use the following parameters to configure the library. All API calls within the current scope are affected.</p><h4>2.1<tt>&nbsp;</tt><a name="(part Basic_Configuration)"></a>Basic Configuration</h4><p>Before making any API calls, the programmer <i>must</i> configure the username and password to use to authenticate with del.icio.us. All communication takes place over SSL, so username and password are secure during transmission over the Internet.</p><p>Note that, in the current version of the del.icio.us API, it is only possible to query/manipulate information in the authenticated account.</p><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:current-username&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:current-username&quot;" class="schemevaluelink">current-username</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameter</span><tt> </tt><span class="schemesymbol">string</span><span class="schemeparen">)</span></p></td></tr></table></p><p>Sets/retrieves the username to use for subsequent del.icio.us API calls.</p><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:current-password&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:current-password&quot;" class="schemevaluelink">current-password</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameter</span><tt> </tt><span class="schemesymbol">string</span><span class="schemeparen">)</span></p></td></tr></table></p><p>Sets/retrieves the password to use for subsequent del.icio.us API calls.</p><p>For example:</p><p><table cellspacing="0" class="schemeblock"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameterize</span><span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemeparen">[</span><span class="schemesymbol">username</span><span class="hspace">&nbsp;</span><span class="schemevalue">"untyped"</span><span class="schemeparen">]</span></p></td></tr><tr><td><p><span class="schemeplain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="schemeparen">[</span><span class="schemesymbol">password</span><span class="hspace">&nbsp;</span><span class="schemevalue">"password"</span><span class="schemeparen">]</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="schemeplain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="schemecomment">; </span><span class="schemecomment">... authenticated API calls go here ...</span><span class="schemeparen">)</span></p></td></tr></table></p><h4>2.2<tt>&nbsp;</tt><a name="(part Advanced_Configuration)"></a>Advanced Configuration</h4><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:current-base-url&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:current-base-url&quot;" class="schemevaluelink">current-base-url</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameter</span><tt> </tt><span class="schemesymbol">string</span><span class="schemeparen">)</span></p></td></tr></table></p><p>The base URL of the API. By default this is:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevalue">"http://api.del.icio.us:443/v1"</span></p><p>Note the following:</p><ul><li><p>While all communication takes place over SSL, the library does not understand the <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">https://</span><span class="hspace"></span></span> protocol in the URL. Instead use <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">http://</span><span class="hspace"></span></span> and specify a port number of <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">443</span><span class="hspace"></span></span>.</p></li><li><p>The URL should <i>not</i> end with a <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">/</span><span class="hspace"></span></span> character.</p></li></ul><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:current-throttle&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:current-throttle&quot;" class="schemevaluelink">current-throttle</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameter</span><tt> </tt><span class="schemesymbol">throttle</span><span class="schemeparen">)</span></p></td></tr></table></p><p>The throttle control to use to limit the rate at which API requests are made.</p><p>del.icio.us can get touchy if you make too many requests too quickly. The documentation states that you must leave a minimum of 1 second between requests, otherwise you will be throttled for up to a few minutes. Experience has shown that persistent use of some of the more "expensive" API requests (such as <span class="schemevariable">all-posts</span>) can cause del.icio.us to throttle clients even if they respect this 1 second gap.</p><p>The <span class="schemevariable">current-throttle</span> parameter takes a <span class="schemevariable">throttle</span> structure that is used to rate limit requests. The default value limits the client to the maximum of 1 request per second. You can change this default value if you find you are frequently being throttled by del.icio.us. See <a href="index.html#(part internals)">Internal Procedures</a> for more information.</p><h4>2.3<tt>&nbsp;</tt><a name="(part Debug_Configuration)"></a>Debug Configuration</h4><p>The following parameters pare provided to help debug problems with the library:</p><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:dump-request-urls?&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:dump-request-urls?&quot;" class="schemevaluelink">dump-request-urls?</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameter</span><tt> </tt><span class="schemesymbol">boolean</span><span class="schemeparen">)</span></p></td></tr></table></p><p>If this parameter is set to <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">#t</span><span class="hspace"></span></span>, the URLs of API calls are printed immediately before each call is made.</p><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:dump-sxml-responses?&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:dump-sxml-responses?&quot;" class="schemevaluelink">dump-sxml-responses?</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameter</span><tt> </tt><span class="schemesymbol">boolean</span><span class="schemeparen">)</span></p></td></tr></table></p><p>If this parameter is set to <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">#t</span><span class="hspace"></span></span>, the SXML versions of all responses are printed as they are parsed. Note that this requires the XML response from del.icio.us to be well-formed.</p><h3>3<tt>&nbsp;</tt><a name="(part api)"></a>API Wrappers</h3><h4>3.1<tt>&nbsp;</tt><a name="(part Special_Values)"></a>Special Values</h4><p><table cellspacing="0" class="boxed"><tr><td><p><a name="definition:&quot;top:empty&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">symbol</span></p></td></tr></table></p><p>The unique symbol <span class="schemevariable">empty</span> is used to represent an unspecified argument to an API call (this is because some API calls take optional boolean arguments).</p><h4>3.2<tt>&nbsp;</tt><a name="(part Result_Structures)"></a>Result Structures</h4><p>The following structures are used to encapsulate data returned by API calls. The same structures can also optionally be used as arguments to some API calls:</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:post-date&quot;"></a><a name="definition:&quot;top:post-tags&quot;"></a><a name="definition:&quot;top:post-extended&quot;"></a><a name="definition:&quot;top:post-description&quot;"></a><a name="definition:&quot;top:post-url&quot;"></a><a name="definition:&quot;top:make-post&quot;"></a><a name="definition:&quot;top:post?&quot;"></a><a name="definition:&quot;top:post&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:post&quot;" class="schemevaluelink">post</a></span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemesymbol">url</span><tt> </tt><span class="schemesymbol">description</span><tt> </tt><span class="schemesymbol">extended</span><tt> </tt><span class="schemesymbol">tags</span><tt> </tt><span class="schemesymbol">date</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">description</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">extended</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">tags</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">srfi-19:date</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></p><p>A del.icio.us post, comprising a bookmark and some metadata:</p><ul><li><p><span class="schemevariable">url</span> - the bookmarked URL;</p></li><li><p><span class="schemevariable">description</span> - the one-line title of the post;</p></li><li><p><span class="schemevariable">extended</span> - extended notes on the post;</p></li><li><p><span class="schemevariable">tags</span> - tags attached to the post;</p></li><li><p><span class="schemevariable">date</span> - the date the post was originally made;</p></li></ul><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:bundle-tags&quot;"></a><a name="definition:&quot;top:bundle-name&quot;"></a><a name="definition:&quot;top:make-bundle&quot;"></a><a name="definition:&quot;top:bundle?&quot;"></a><a name="definition:&quot;top:bundle&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:bundle&quot;" class="schemevaluelink">bundle</a></span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemesymbol">name</span><tt> </tt><span class="schemesymbol">tags</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">tags</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="schemeparen">)</span></p></td></tr></table></p><p>A <i>tag bundle</i>: a named collection of tags. Note that bundles may <i>not</i> be used in place of tags, either as members of other bundles or as <span class="schemevariable">tag</span> arguments to API calls. This limits their usefulness in the API, although they still appear on the del.icio.us web site.</p><ul><li><p><span class="schemevariable">name</span> - the name of the bundle;</p></li><li><p><span class="schemevariable">tags</span> - tags in the bundle.</p></li></ul><h4>3.3<tt>&nbsp;</tt><a name="(part Exceptions)"></a>Exceptions</h4><p>The following exceptions may be raised by any API procedure call:</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:make-exn:delicious&quot;"></a><a name="definition:&quot;top:exn:delicious?&quot;"></a><a name="definition:&quot;top:exn:delicious&quot;"></a><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:delicious&quot;" class="schemevaluelink">exn:delicious</a></span><tt> </tt><span class="schemesymbol">exn</span><span class="schemeparen">)</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr></table></p><p>Abstract exception supertype. Subtypes of this exception represent failures that are typically the fault of the user, rather than this library or del.icio.us itself.</p><p>Applications should respond to exceptions of this type by displaying a "you messed up" style dialog box or feedback message.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:make-exn:fail:delicious&quot;"></a><a name="definition:&quot;top:exn:fail:delicious?&quot;"></a><a name="definition:&quot;top:exn:fail:delicious&quot;"></a><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:fail:delicious&quot;" class="schemevaluelink">exn:fail:delicious</a></span><tt> </tt><span class="schemesymbol">exn</span><span class="schemeparen">)</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr></table></p><p>Abstract exception supertype. Subtypes of this exception represent failures that are typically the fault of this library or del.icio.us.</p><p>Applications should respond to exceptions of this type by displaying an "unexpected error" style dialog box or feedback message.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:make-exn:delicious:auth&quot;"></a><a name="definition:&quot;top:exn:delicious:auth?&quot;"></a><a name="definition:&quot;top:exn:delicious:auth&quot;"></a><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:delicious:auth&quot;" class="schemevaluelink">exn:delicious:auth</a></span><tt> </tt><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:delicious&quot;" class="schemevaluelink">exn:delicious</a></span><span class="schemeparen">)</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr></table></p><p>Raised if del.icio.us returns an HTTP 403 response. This typically means the username/password were invalid.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:make-exn:fail:delicious:throttled&quot;"></a><a name="definition:&quot;top:exn:fail:delicious:throttled?&quot;"></a><a name="definition:&quot;top:exn:fail:delicious:throttled&quot;"></a><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:fail:delicious:throttled&quot;" class="schemevaluelink">exn:fail:delicious:throttled</a></span><tt> </tt><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:fail:delicious&quot;" class="schemevaluelink">exn:fail:delicious</a></span><span class="schemeparen">)</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr></table></p><p>Raised if del.icio.us returns an HTTP 503 response. del.icio.us is very sensitive to request spamming or over-use. This library contains an auto-throttling element that prevents applications making more than the one permitted request per second, but excessive use of "expensive" requests such as <span class="schemevariable">all-posts</span> can still trigger throttling.</p><p>Applications should respond to exceptions of this type by backing off for 30 seconds to a few minutes, until del.icio.us switches its throttle protection off again.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0"><tr><td><p><span class="schemeparen">(struct</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><a name="definition:&quot;top:exn:fail:delicious:parse-fragment&quot;"></a><a name="definition:&quot;top:make-exn:fail:delicious:parse&quot;"></a><a name="definition:&quot;top:exn:fail:delicious:parse?&quot;"></a><a name="definition:&quot;top:exn:fail:delicious:parse&quot;"></a><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:fail:delicious:parse&quot;" class="schemevaluelink">exn:fail:delicious:parse</a></span><tt> </tt><span class="schemesymbol"><a href="index.html#definition:&quot;top:exn:fail:delicious&quot;" class="schemevaluelink">exn:fail:delicious</a></span><span class="schemeparen">)</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemeparen">(</span><span class="schemesymbol">fragment</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:immutable</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td colspan="3"><p><span class="schemeparen">#:inspector</span><span class="hspace">&nbsp;</span><span class="schemevalue">#f</span><span class="schemeparen">)</span></p></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemesymbol">fragment</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">sxml</span></p></td></tr></table></p><p>Raised if the library was unable to parse an XML response. This implies the result was well-formed XML with an unexpected structure. The <span class="schemevariable">fragment</span> field contains the problematic SXML fragment.</p><p>If you get one of these, it&rsquo;s time to switch on the <span class="schemevariable">dump-sxml-responses?</span> parameter and start hunting for bugs in this library. Note that, while bug reports are gratefully received, bug reports <i>and</i> fixes are infinitely preferable.</p><h4>3.4<tt>&nbsp;</tt><a name="(part API_Procedures)"></a>API Procedures</h4><p>The following procedures are wrappers for the various del.icio.us API calls. All calls require the <span class="schemevariable">current-username</span> and <span class="schemevariable">current-password</span> parameters to be set.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:last-updated&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:last-updated&quot;" class="schemevaluelink">last-updated</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">srfi-19:date</span></p></td></tr></table></p><p>Returns the (SRFI-19) date of the last post to the account.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:get-tags&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:get-tags&quot;" class="schemevaluelink">get-tags</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">alist-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol">integer</span><span class="schemeparen">)</span></p></td></tr></table></p><p>Returns an association list of tags to number of uses.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:rename-tag!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:rename-tag!&quot;" class="schemevaluelink">rename-tag!</a></span><tt> </tt><span class="schemevariable">old-name</span><tt> </tt><span class="schemevariable">new-name</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">old-name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">new-name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr></table></p><p>Renames a tag and propagates the change to all related posts. For example:</p><p><table cellspacing="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><tt>&gt; </tt><span class="schemeparen">(</span><span class="schemesymbol">length</span><tt> </tt><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:get-posts&quot;" class="schemevaluelink">get-posts</a></span><tt> </tt><span class="schemevalue">"untyped"</span><span class="schemeparen">)</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemeresult">0</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><tt>&gt; </tt><span class="schemeparen">(</span><span class="schemesymbol">length</span><tt> </tt><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:get-posts&quot;" class="schemevaluelink">get-posts</a></span><tt> </tt><span class="schemevalue">"un-typed"</span><span class="schemeparen">)</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemeresult">1</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><tt>&gt; </tt><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:rename-tag!&quot;" class="schemevaluelink">rename-tag!</a></span><tt> </tt><span class="schemevalue">"un-typed"</span><tt> </tt><span class="schemevalue">"untyped"</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><tt>&gt; </tt><span class="schemeparen">(</span><span class="schemesymbol">length</span><tt> </tt><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:get-posts&quot;" class="schemevaluelink">get-posts</a></span><tt> </tt><span class="schemevalue">"untyped"</span><span class="schemeparen">)</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemeresult">1</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><tt>&gt; </tt><span class="schemeparen">(</span><span class="schemesymbol">length</span><tt> </tt><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:get-posts&quot;" class="schemevaluelink">get-posts</a></span><tt> </tt><span class="schemevalue">"un-typed"</span><span class="schemeparen">)</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemeresult">0</span></p></td></tr></table></p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:get-posts&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:get-posts&quot;" class="schemevaluelink">get-posts</a></span><tt> </tt><span class="schemeopt">[</span><span class="schemevariable">tag</span><tt> </tt><span class="schemevariable">date</span><tt> </tt><span class="schemevariable">url</span><span class="schemeopt">]</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:post&quot;" class="schemevaluelink">post</a></span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">tag</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">srfi-19:date</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr></table></p><p>Returns all posts matching the arguments:</p><ul><li><p><span class="schemevariable">tag</span> - filter by the specified tag (one tag only);</p></li><li><p><span class="schemevariable">date</span> - filter by the specified post date;</p></li><li><p><span class="schemevariable">url</span> - filter by the specified URL (must be an exact match).</p></li></ul><p>If all arguments are <span class="schemevariable">empty</span>, posts are returned from the most recent day of posting.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:recent-posts&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:recent-posts&quot;" class="schemevaluelink">recent-posts</a></span><tt> </tt><span class="schemeopt">[</span><span class="schemevariable">tag</span><tt> </tt><span class="schemevariable">count</span><span class="schemeopt">]</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:post&quot;" class="schemevaluelink">post</a></span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">tag</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">count</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">integer</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr></table></p><p>Returns a list of the most recent posts:</p><ul><li><p><span class="schemevariable">tag</span> - as above;</p></li><li><p><span class="schemevariable">count</span> - limit to the specified number of posts: default 15, max 100.</p></li></ul><p>The default value of <span class="schemevariable">count</span> is 15.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:all-posts&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:all-posts&quot;" class="schemevaluelink">all-posts</a></span><tt> </tt><span class="schemeopt">[</span><span class="schemevariable">tag</span><span class="schemeopt">]</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:post&quot;" class="schemevaluelink">post</a></span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">tag</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr></table></p><p>Returns all posts.</p><p>The del.icio.us documentation notes: "Please use sparingly. Call the update function to see if you need to fetch this at all." Frequent use can result in throttling.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:post-dates&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:post-dates&quot;" class="schemevaluelink">post-dates</a></span><tt> </tt><span class="schemeopt">[</span><span class="schemevariable">tag</span><span class="schemeopt">]</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">alist-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol">srfi-19:date</span><span class="hspace">&nbsp;</span><span class="schemesymbol">integer</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">tag</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr></table></p><p>Returns an association list of post dates to number of posts made on that day.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:add-post!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:add-post!&quot;" class="schemevaluelink">add-post!</a></span><tt> </tt><span class="schemevariable">post</span><tt> </tt><span class="schemeopt">[</span><span class="schemevariable">replace?</span><tt> </tt><span class="schemevariable">shared?</span><span class="schemeopt">]</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">post</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">post</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">replace?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">boolean</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">shared?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">boolean</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr></table></p><p>Creates a new post given a <span class="schemevariable">post</span> structure.</p><ul><li><p><span class="schemevariable">post</span> - the post to post;</p></li><li><p><span class="schemevariable">replace?</span> - replace a previous post if the URL has already been posted: default no;</p></li><li><p><span class="schemevariable">shared?</span> - make the post public: default no.</p></li></ul><p>This procedure delegates to <span class="schemevariable">add-post/raw!</span> to do most of the work. Fields in the post are automatically mapped to <span class="schemevariable">empty</span> when appropriate.</p><p><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="prototype"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:add-post/raw!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:add-post/raw!&quot;" class="schemevaluelink">add-post/raw!</a></span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemevariable">url</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemevariable">description</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span>[</p></td><td><p><span class="schemevariable">extended</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemevariable">tags</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemevariable">date</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemevariable">replace?</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemevariable">shared?</span>]<span class="schemeparen">)</span></p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p>&rarr;</p></td><td><p><span class="hspace">&nbsp;</span></p></td><td><p><span class="schemesymbol">void</span></p></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">description</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">extended</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">tags</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">date</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">srfi-19:date</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">replace?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">boolean</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">shared?</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">U</span><span class="hspace">&nbsp;</span><span class="schemesymbol">boolean</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>=<span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:empty&quot;" class="schemevaluelink">empty</a></span></p></td></tr></table></p><p>Creates a new post given the constituent parts of a <span class="schemevariable">post</span> structure. <span class="schemevariable">url</span>, <span class="schemevariable">description</span>, <span class="schemevariable">extended</span>, <span class="schemevariable">tags</span> and <span class="schemevariable">date</span> have the same purpose as the relevant fields of <span class="schemevariable">post</span>.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:delete-post!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:delete-post!&quot;" class="schemevaluelink">delete-post!</a></span><tt> </tt><span class="schemevariable">post</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">post</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">post</span></p></td></tr></table></p><p>Deletes an existing post given a <span class="schemevariable">post</span> structure.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:delete-post/raw!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:delete-post/raw!&quot;" class="schemevaluelink">delete-post/raw!</a></span><tt> </tt><span class="schemevariable">url</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">url</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr></table></p><p>Deletes an existing post given a URL.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:all-bundles&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:all-bundles&quot;" class="schemevaluelink">all-bundles</a></span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:bundle&quot;" class="schemevaluelink">bundle</a></span><span class="schemeparen">)</span></p></td></tr></table></p><p>Returns a list of tag bundles in the current account.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:update-bundle!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:update-bundle!&quot;" class="schemevaluelink">update-bundle!</a></span><tt> </tt><span class="schemevariable">bundle</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">bundle</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">bundle</span></p></td></tr></table></p><p>Creates or updates a tag bundle given a <span class="schemevariable">bundle</span> structure. This procedure delegates to <span class="schemevariable">update-bundle/raw!</span> to do most of the work.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:update-bundle/raw!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:update-bundle/raw!&quot;" class="schemevaluelink">update-bundle/raw!</a></span><tt> </tt><span class="schemevariable">name</span><tt> </tt><span class="schemevariable">tags</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">tags</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">list-of</span><span class="hspace">&nbsp;</span><span class="schemesymbol">string</span><span class="schemeparen">)</span></p></td></tr></table></p><p>Creates or updates a tag bundle given its constituent parts.</p><ul><li><p><span class="schemevariable">name</span> - the name of the tag bundle to create/update;</p></li><li><p><span class="schemevariable">tags</span> - the (new) contents of the bundle.</p></li></ul><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:delete-bundle!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:delete-bundle!&quot;" class="schemevaluelink">delete-bundle!</a></span><tt> </tt><span class="schemevariable">bundle</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">bundle</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">bundle</span></p></td></tr></table></p><p>Deletes a bundle given a <span class="schemevariable">bundle</span> structure.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:delete-bundle/raw!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:delete-bundle/raw!&quot;" class="schemevaluelink">delete-bundle/raw!</a></span><tt> </tt><span class="schemevariable">name</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">name</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">string</span></p></td></tr></table></p><p>Deletes a bundle given its name.</p><h3>4<tt>&nbsp;</tt><a name="(part internals)"></a>Internal Procedures</h3><h4>4.1<tt>&nbsp;</tt><a name="(part Throttle)"></a>Throttle</h4><p>The file <tt>"throttle.ss"</tt> contains procedures that control the rate at which the client sends requests to del.icio.us.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:make-throttle&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:make-throttle&quot;" class="schemevaluelink">make-throttle</a></span><tt> </tt><span class="schemevariable">delay</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">throttle</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">delay</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">integer</span></p></td></tr></table></p><p>Creates a <span class="schemevariable">throttle</span> structure that manages a queue of <i>requests</i> to run "throttled sections" of code. The throttle responds to requests in the order in which they are received, ensuring that <span class="schemevariable">delay</span> milliseconds are allowed to pass between the <i>end</i> of one call and the <i>beginning</i> of the next. This behaviour is enforced in single- and multi-threaded environments.</p><p>Use this procedure in conjunction with the <span class="schemevariable">current-throttle</span> parameter to change the rate at which the client makes calls to del.icio.us. For example:</p><p><table cellspacing="0" class="schemeblock"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">let</span><span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemeparen">[</span><span class="schemesymbol">throttle</span><span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:make-throttle&quot;" class="schemevaluelink">make-throttle</a></span><span class="hspace">&nbsp;</span><span class="schemevalue">2000</span><span class="schemeparen">)</span><span class="schemeparen">]</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="schemeplain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">parameterize</span><span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemeparen">[</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:current-throttle&quot;" class="schemevaluelink">current-throttle</a></span><span class="hspace">&nbsp;</span><span class="schemesymbol">throttle</span><span class="schemeparen">]</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="schemeplain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="schemecomment">; </span><span class="schemecomment">... API calls throttled to at most 1 every 2 seconds ...</span><span class="schemeparen">)</span></p></td></tr><tr><td><p><span class="schemeplain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol"><a href="index.html#definition:&quot;top:kill-throttle!&quot;" class="schemevaluelink">kill-throttle!</a></span><span class="hspace">&nbsp;</span><span class="schemesymbol">throttle</span><span class="schemeparen">)</span><span class="schemeparen">)</span></p></td></tr></table></p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:call-with-throttle&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:call-with-throttle&quot;" class="schemevaluelink">call-with-throttle</a></span><tt> </tt><span class="schemevariable">throttle</span><tt> </tt><span class="schemevariable">thunk</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">any</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">throttle</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">throttle</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">thunk</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemeparen">(</span><span class="schemesymbol">-&gt;</span><span class="hspace">&nbsp;</span><span class="schemesymbol">any</span><span class="schemeparen">)</span></p></td></tr></table></p><p>Makes a throttled call to <span class="schemevariable">thunk</span>. <span class="schemevariable">call-with-throttle</span> sends a message to <span class="schemevariable">throttle</span>, asking if it can run the throttled section in <span class="schemevariable">thunk</span>. <span class="schemevariable">throttle</span> adds the requests to its queue and behaves as described in the documentation for <span class="schemevariable">make-throttle</span> above.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:throttle?&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:throttle?&quot;" class="schemevaluelink">throttle?</a></span><tt> </tt><span class="schemevariable">x</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">boolean</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">x</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemesymbol">any</span></p></td></tr></table></p><p>Returns <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">#t</span><span class="hspace"></span></span> if <span class="schemevariable">x</span> is a <span class="schemevariable">throttle</span>, <span class="schemeinputbg"><span class="hspace"></span><span class="schemeinput">#t</span><span class="hspace"></span></span> otherwise.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:throttle-delay&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:throttle-delay&quot;" class="schemevaluelink">throttle-delay</a></span><tt> </tt><span class="schemevariable">throttle</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">integer</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">throttle</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">throttle</span></p></td></tr></table></p><p>Returns the delay enforced by <span class="schemevariable">throttle</span> in milliseconds.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:kill-throttle!&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:kill-throttle!&quot;" class="schemevaluelink">kill-throttle!</a></span><tt> </tt><span class="schemevariable">throttle</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">void</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">throttle</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">throttle</span></p></td></tr></table></p><p><span class="schemevariable">throttle</span> objects use threads to handle requests. When you have finished using a <span class="schemevariable">throttle</span>, you can (and should) call this procedure to kill its thread and free up the system resources it was using. Once a throttle has been killed, it can no longer be used in calls to <span class="schemevariable">call-with-throttle</span>.</p><p>You can also kill a throttle by shutting down the custodian that was current when it was created.</p><p><table cellspacing="0" class="boxed"><tr><td><p><span class="schemeparen">(</span><a name="definition:&quot;top:throttle-alive?&quot;"></a><span class="schemesymbol"><a href="index.html#definition:&quot;top:throttle-alive?&quot;" class="schemevaluelink">throttle-alive?</a></span><tt> </tt><span class="schemevariable">throttle</span><span class="schemeparen">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="schemesymbol">boolean</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="schemevariable">throttle</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="schemevariable">throttle</span></p></td></tr></table></p><p>This procedure determines whether or not a throttle has been killed with the <span class="schemevariable">kill-throttle</span> procedure.</p><h3>5<tt>&nbsp;</tt><a name="(part testing)"></a>Testing</h3><p>Delicious.plt has a reasonably comprehensive test suite, written using the
<i>SchemeUnit</i> library. Use the following shell command to run the
tests:</p><p><span class="hspace">&nbsp;&nbsp;</span><tt>mzscheme -mtv run-tests.ss</tt></p><p>The test suite uses a dedicated del.icio.us account to test API calls. The
<span class="schemevariable">api-test</span> test suite automatically sets up the correct username and
password, and deletes all posts and bundles before and after the relevant
tests.</p><p>Note that, because of throttling, the tests may take a while to run.</p><h3>6<tt>&nbsp;</tt><a name="(part Acknowledgements)"></a>Acknowledgements</h3><p>Many thanks to the following contributors:</p><ul><li><p>Eric Hanchrow</p></li></ul></div></body></html>